<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Content/Users/NewUser/NewUser.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Content/Users/NewUser/NewUser.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect } from 'react';

/**
 * 
 * @param props
 * @param {Array} props.users
 * @returns formularz dodawania użytkownika 
 */
function NewUser(props) {

    const [showForm, setshowForm] = useState(false);
    const [newUser, setNewUser] = useState({
        firstName: '',
        lastName: '',
        email: '',
        phone: '',
        position: '',
        nrIndeks: ''
    })

    const [errors, setErrors] = useState({
        firstName: '',
        lastName: '',
        email: '',
        phone: '',
        position: '',
        nrIndeks: '',
    })

    /**
     * Funkcja, która po wpisaniu znaków do okienka formularzu zmienia wartość stanu obiektu
     * @function changeHandler 
     * @param event 
     */
    const changeFirstNameHandler = event => {
        const value = event.target.value.toUpperCase();
        setNewUser({...newUser, firstName: value});
    }

    const changeLastNameHandler = event => {
        const value = event.target.value.toUpperCase();
        setNewUser({...newUser, lastName: value});
    }

    const changeEmailHandler = event => {
        const value = event.target.value.toLowerCase();
        setNewUser({...newUser, email: value});
    }

    const changePhoneHandler = event => {
        const value = event.target.value;
        setNewUser({...newUser, phone: value});
    }

    const changePositionHandler = event => {
        const value = event.target.value;
        setNewUser({...newUser, position: value});
    }

    const changeNrIndeksHandler = event => {
        const value = event.target.value;
        setNewUser({...newUser, nrIndeks: value});
    }

/**
 * funkcja tworzy i przekazuje obiekt do funkcji która dodają go do kolkecji danych 
 * @function addObject
 */
    const addUser = () => {
        const user = {
            firstName: newUser.firstName,
            lastName: newUser.lastName,
            position: newUser.position,
            email: newUser.email,
            phone: newUser.phone,
            nrIndeks: newUser.nrIndeks,
        };
        props.onAdd(user);
        setNewUser({})
        setshowForm(false);
    }

     // function validateName(name) {
    //     const re = 
    // }

    /**
     * @function validateEmail
     * @param {String} email 
     * @returns czy email jest poprawnie zapisany
     */
    function validateEmail(email) {
        const re = /^(([^&lt;>()[\]\\.,;:\s@"]+(\.[^&lt;>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email)
    }

    /**
     * @function sameValue
     * @returns czy istnieje już obiekt posiadający takie same dane
     */
    const sameEmail = () => {
        const exist = [...props.users].filter(x=>x.email===newUser.email)
        if ( exist[0] ){
            return true
        }else{
            return false
        }
    }

    const sameDocument = () => {
        const exist = [...props.users].filter(x=>x.nrIndeks===newUser.nrIndeks)
        if ( exist[0] ){
            return true
        }else{
            return false
        }
    }

    const samePhone = () => {
        const exist = [...props.users].filter(x=>x.phone===newUser.phone)
        if ( exist[0] ){
            return true
        }else{
            return false
        }
    }

    useEffect (() => {
        if (newUser.firstName&amp;&amp;newUser.firstName.length>=3 &amp;&amp; newUser.firstName.length &lt; 30) {
            setErrors({...errors, firstName: ''})
        } else {
            setErrors({...errors, firstName: 'Imię powinno zawierać 3 - 30 znaków'})
        }
    }, [newUser.firstName])
    
    useEffect (() => {
        if (newUser.lastName&amp;&amp;newUser.lastName.length>=3 &amp;&amp; newUser.lastName.length &lt; 30) {
            setErrors({...errors, lastName: ''})
        } else {
            setErrors({...errors, lastName: 'Nazwisko powinno zawierać 3 - 30 znaków'})
        }
    }, [newUser.lastName])

    useEffect (() => {
        if (!newUser.nrIndeks||newUser.nrIndeks.length===0) {
            setErrors({...errors, nrIndeks: 'Puste pole'})
        } else if(sameDocument()){
            setErrors({...errors, nrIndeks: 'Istnieje osoba o tym numerze dokumentu'})
        }else{
            setErrors({...errors, nrIndeks: ''})
        }
    }, [newUser.nrIndeks])

    useEffect (() => {
        if (validateEmail(newUser.email)|| '') {
            if (sameEmail()) {
                setErrors({...errors, email: 'Istnieje osoba posiadająca ten e-mail'}) 
            }else{
            setErrors({...errors, email: ''})
            }
        } else {
            setErrors({...errors, email: 'Niepoprawny e-mail'})
        }
    }, [newUser.email])

    useEffect (() => {
        if (isNaN(newUser.phone)) {
        setErrors({...errors, phone: 'Niepoprawny numer telefonu'})
        } else if  (newUser.phone.length >= 4 &amp;&amp; newUser.phone.length &lt;= 15 ) {
            if( samePhone()) {
                setErrors({...errors, phone: 'Istnieje osoba posiadająca ten numer telefonu'})    
            }else{
            setErrors({...errors, phone: ''})
            }
        }else{
            setErrors({...errors, phone: 'Numer telefonu powinien zawierać 4 - 15 cyfr '})
        }
    }, [newUser.phone])
    
    const disabledBtn = 
        Object.values(errors).filter(x => x).length
        || !(Object.values(newUser).filter(x => x).length===6)

    return(
        showForm ? (
        &lt;div className="form-group">
            &lt;label>Imię:&lt;/label>
            &lt;input 
                className = {`form-control ${errors.firstName ? 'is-invalid' : ''}`}
                type="text" 
                value={newUser.firstName} 
                onChange={changeFirstNameHandler} />
                &lt;div className="invalid-feedback">
                    {errors.firstName}
                &lt;/div> 
            &lt;br/>
            &lt;label>Nazwisko:&lt;/label>
            &lt;input 
                className = {`form-control ${errors.lastName ? 'is-invalid' : ''}`}
                type="text" 
                value={newUser.lastName}
                onChange={changeLastNameHandler} />
                &lt;div className="invalid-feedback">
                    {errors.lastName}
                &lt;/div> 
            &lt;br/>
            &lt;label>Pozycja:&lt;/label>
            &lt;input 
                className = "form-control"
                type="text" 
                value={newUser.position}
                onChange={changePositionHandler} /> 
            &lt;br/>
            &lt;label>Numer Dokumentu&lt;/label>
            &lt;input 
                className = {`form-control ${errors.nrIndeks ? 'is-invalid' : ''}`}
                type="text" 
                value={newUser.nrIndeks}
                onChange={changeNrIndeksHandler} />
                &lt;div className="invalid-feedback">
                    {errors.nrIndeks}
                &lt;/div> 
            &lt;br/>
            &lt;label>E-mail:&lt;/label>
            &lt;input 
                className = {`form-control ${errors.email ? 'is-invalid' : ''}`}
                type="email" 
                value={newUser.email}
                onChange={changeEmailHandler} />
                &lt;div className="invalid-feedback">
                    {errors.email}
                &lt;/div>   
            &lt;br/>
            &lt;label>Telefon:&lt;/label>
            &lt;input 
                className = {`form-control ${errors.phone ? 'is-invalid' : ''}`}
                type="text" 
                value={newUser.phone}
                onChange={changePhoneHandler} />
                &lt;div className="invalid-feedback">
                    {errors.phone}
                &lt;/div> 

            &lt;button onClick={() => addUser()} disabled={disabledBtn}>Dodaj&lt;/button>
        &lt;/div>
        ) : (
            &lt;button onClick={() => setshowForm(true)}>Nowy&lt;/button>
        )
    );
}

export default NewUser;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ErrorBoundary.html">ErrorBoundary</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addObject">addObject</a></li><li><a href="global.html#addUser">addUser</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#changeContent">changeContent</a></li><li><a href="global.html#changeHandler">changeHandler</a></li><li><a href="global.html#Clock">Clock</a></li><li><a href="global.html#colorChange">colorChange</a></li><li><a href="global.html#Content">Content</a></li><li><a href="global.html#DataHeader">DataHeader</a></li><li><a href="global.html#deleteUser">deleteUser</a></li><li><a href="global.html#editHandler">editHandler</a></li><li><a href="global.html#EditUser">EditUser</a></li><li><a href="global.html#editUser">editUser</a></li><li><a href="global.html#editUserHandler">editUserHandler</a></li><li><a href="global.html#fetchBack">fetchBack</a></li><li><a href="global.html#focusInput">focusInput</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#Layout">Layout</a></li><li><a href="global.html#Loading">Loading</a></li><li><a href="global.html#makeTemp">makeTemp</a></li><li><a href="global.html#Menu">Menu</a></li><li><a href="global.html#monthBefore">monthBefore</a></li><li><a href="global.html#NewUser">NewUser</a></li><li><a href="global.html#onEdit">onEdit</a></li><li><a href="global.html#reducer">reducer</a></li><li><a href="global.html#RoomsCalendar">RoomsCalendar</a></li><li><a href="global.html#sameValue">sameValue</a></li><li><a href="global.html#Search">Search</a></li><li><a href="global.html#searchHandler">searchHandler</a></li><li><a href="global.html#Searching">Searching</a></li><li><a href="global.html#tableMaker">tableMaker</a></li><li><a href="global.html#toggleModal">toggleModal</a></li><li><a href="global.html#User">User</a></li><li><a href="global.html#Users">Users</a></li><li><a href="global.html#validateEmail">validateEmail</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Sep 03 2021 15:52:50 GMT+0200 (czas środkowoeuropejski letni)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
